<!DOCTYPE html>
<html>  
    <head>
        <meta charset="utf-8">
         <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />
        
        <title>JSmol Panel</title>
       
        
        <link rel="stylesheet" type="text/css" href="style/style.css">
        <script type="text/javascript" src="JSmol.min.js"></script>
        <script type="text/javascript">

            Jmol._isAsync = false;

            // last update 2/18/2014 2:10:06 PM

            var jsmol; // set up in HTML table, below

            // logic is set by indicating order of USE -- default is HTML5 for this test page, though

            var s = document.location.search;

            // Developers: The _debugCode flag is checked in j2s/core/core.z.js, 
            // and, if TRUE, skips loading the core methods, forcing those
            // to be read from their individual directories. Set this
            // true if you want to do some code debugging by inserting
            // System.out.println, document.title, or alert commands
            // anywhere in the Java or Jmol code.

            Jmol._debugCode = (s.indexOf("debugcode") >= 0);
            var pdb = getParameterByName('pdb');
            var peptideMapQuery = 'select  chain=' + getParameterByName('chain') + '; color ' + getParameterByName('color'); /*'select resno >='+getParameterByName('start')+'and resno <='+getParameterByName('end')+' and chain = '+getParameterByName('chain')+'color '+getParameterByName('color');*/
            jmol_isReady = function (applet) {
                document.title = (applet._id + " - Jmol " + Jmol.___JmolVersion)
                Jmol._getElement(applet, "appletdiv").style.border = "none";
                Jmol.search(jsmol, '=' + pdb, 'spin on; ribbon only; background white;' + peptideMapQuery);



            }

            /**"select resno >=" + (peptideTempStart - chains[selectedChainIndex - 1].getDifference())
             + " and resno <=" + (peptideTempEnd - chains[selectedChainIndex - 1].getDifference())
             + " and chain = " + currentChain + "; color green")*/

            var Info = {
                width: getParameterByName('w'),
                height: getParameterByName('h'),
                debug: false,
                color: "0xFFFFFF",
                addSelectionOptions: true,
                use: "HTML5", // JAVA HTML5 WEBGL are all options
                j2sPath: "./j2s", // this needs to point to where the j2s directory is.
                jarPath: "./java", // this needs to point to where the java directory is.
                jarFile: "JmolAppletSigned.jar",
                isSigned: true,
                script: "set zoomlarge false;set antialiasDisplay;",
                serverURL: "http://chemapps.stolaf.edu/jmol/jsmol/php/jsmol.php",
                readyFunction: jmol_isReady,
                disableJ2SLoadMonitor: true,
                disableInitialConsole: true,
                allowJavaScript: true,
                spinning: true,
                //defaultModel: "$dopamine",
                //console: "none", // default will be jsmol_infodiv, but you can designate another div here or "none"
            }

            $(document).ready(function () {
                $("#appdiv").html(Jmol.getAppletHtml("jsmol", Info));

                document.getElementById('jmolApplet0_canvas2d').style.width = '50%';
                document.getElementById('jsmol_submit').style.border = '2px solid red';

            })
            var lastPrompt = 0;

            function getParameterByName(name, url) {
                if (!url)
                    url = window.location.href;
                name = name.replace(/[\[\]]/g, "\\$&");
                var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                        results = regex.exec(url);
                if (!results)
                    return null;
                if (!results[2])
                    return '';
                return decodeURIComponent(results[2].replace(/\+/g, " "));
            }
        </script>
    </head>
    <body id="outerhtml">
        <table width=1000 cellpadding=10>
            <tr><td valign="top" >
            <center>    
                <div id="appdiv"></div>
                <table cellpadding=5><tr><td valign=top></table>
            </center>
        </td>
    </tr></table>
<script>Jmol._applets['jmolApplet0']._search()</script>
</body>
</html>
